<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Other head elements -->
    <script src="{{ url_for('static', filename='js/html5-qrcode.min.js') }}"></script>
</head>
<body>
    {% extends 'base.html' %}

    {% block content %}
        <h2>Crear Albarán</h2>
        <form action="{{ url_for('create_albaran') }}" method="post">
            <label for="albaran_id">Número de Albarán:</label>
            <input type="number" id="albaran_id" name="albaran_id" required><br>

            <label for="cliente_id">Cliente:</label>
            <select id="cliente_id" name="cliente_id" required>
                {% for cliente in clientes %}
                <option value="{{ cliente.cliente_id }}">{{ cliente.nombre }}</option>
                {% endfor %}
            </select><br>

            <label for="portestotales">Portes Totales:</label>
            <input type="text" id="portestotales" name="portestotales"><br>

            <h3>Lineas de Producto</h3>
            <div id="lineas-producto-container">
                <div class="linea-producto">
                    <!-- Product Line Fields -->
                    <label for="nombreproducto">Nombre Producto:</label>
                    <select id="nombreproducto" name="nombreproducto[]">
                        {% for producto in productos %}
                        <option value="{{ producto.nombreProducto }}">{{ producto.nombreProducto }}</option>
                        {% endfor %}
                    </select><br>

                    <label for="intervalopesos">Intervalo Pesos:</label>
                    <input type="text" id="intervalopesos" name="intervalopesos[]"><br>

                    <label for="descripcion">Descripción:</label>
                    <select id="descripcion" name="descripcion[]">
                        {% for desc in descripciones %}
                        <option value="{{ desc.descripcion }}">{{ desc.descripcion }}</option>
                        {% endfor %}
                    </select><br>

                    <label for="numerocajas">Número de Cajas:</label>
                    <input type="text" id="numerocajas" name="numerocajas[]"><br>

                    <label for="tipocaja">Tipo de Caja:</label>
                    <select id="tipocaja" name="tipocaja[]">
                        {% for caja in tipos_caja %}
                        <option value="{{ caja.tipocaja }}">{{ caja.tipocaja }}</option>
                        {% endfor %}
                    </select><br>

                    <label for="kilos">Kilos:</label>
                    <input type="text" id="kilos" name="kilos[]"><br>

                    <label for="precio">Precio:</label>
                    <input type="text" id="precio" name="precio[]"><br>

                    <label for="preciocompra">Precio Compra:</label>
                    <input type="text" id="preciocompra" name="preciocompra[]"><br>

                    <label for="porteskg">Portes/Kg:</label>
                    <input type="text" id="porteskg" name="porteskg[]"><br>

                    <label for="beneficiokg">Beneficio/Kg:</label>
                    <input type="text" id="beneficiokg" name="beneficiokg[]"><br>

                    <!-- QR Code Scanner Section -->
                    <button type="button" class="add-etiqueta">Añadir Etiqueta</button>
                    <div class="etiquetas-container" data-linea-id="0"></div>
                    <button type="button" class="remove-linea">Eliminar Línea</button>
                    <hr>
                </div>
            </div>
            <button type="button" id="add-linea">Añadir Línea de Producto</button><br>
            <button type="submit">Guardar Albarán</button>
        </form>

        <!-- QR Code Scanner Modal -->
        <div id="qr-scanner-modal" style="display:none;">
            <div id="qr-reader" style="width:500px"></div>
            <button id="close-qr-scanner">Cerrar</button>
        </div>

        <script src="{{ url_for('static', filename='script.js') }}"></script>
    {% endblock %}
</body>
</html>
